<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DALL·E API Interface</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Optional JavaScript; choose one of the two! -->
    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        /* ... (unchanged styles) */
    </style>
</head>

<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col">
                <div class="mb-3">
                    <label for="selectedDate" class="form-label">날짜 선택:</label>
                    <input type="date" class="form-control" id="selectedDate" required>
                </div>

                <div class="input-group mb-3">
                    <input type="text" class="form-control" id="prompt" placeholder="ex:탕후루를 먹었다 이빨이 아파서 병원에 갔다 치료를 하고 잠에 들었다" value="">

                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="joyCheckbox" value="기쁨">
                        <label class="form-check-label" for="joyCheckbox">기쁨</label>
                    </div>
                    
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="sadnessCheckbox" value="슬픔">
                        <label class="form-check-label" for="sadnessCheckbox">슬픔</label>
                    </div>
                    
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="depressionCheckbox" value="우울">
                        <label class="form-check-label" for="depressionCheckbox">우울</label>
                    </div>
                    
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="happinessCheckbox" value="행복">
                        <label class="form-check-label" for="happinessCheckbox">행복</label>
                    </div>
                    
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" id="angerCheckbox" value="분노">
                        <label class="form-check-label" for="angerCheckbox">분노</label>
                    </div>
                    
                   
                    </div>
                    
                    <!-- 추가된 부분: 행동 체크박스 -->
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="soccerCheckbox" value="축구를 했다">
                            <label class="form-check-label" for="soccerCheckbox">축구를 했다</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="gameCheckbox" value="게임을 했다">
                            <label class="form-check-label" for="gameCheckbox">게임을 했다</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="studyCheckbox" value="공부를 했다">
                            <label class="form-check-label" for="studyCheckbox">공부를 했다</label>
                        </div>
                    </div>

                    <!-- 추가된 부분: 날씨 체크박스 -->
                    
                    <div class="col">
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="soccerCheckbox" value="맑음">
                            <label class="form-check-label" for="soccerCheckbox">맑음</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="gameCheckbox" value="흐림">
                            <label class="form-check-label" for="gameCheckbox">흐림</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="studyCheckbox" value="비">
                            <label class="form-check-label" for="studyCheckbox">비</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="gameCheckbox" value="눈">
                            <label class="form-check-label" for="gameCheckbox">눈</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="studyCheckbox" value="천둥번개">
                            <label class="form-check-label" for="studyCheckbox">천둥번개</label>
                        </div>
                    </div>

                    
                    <div class="col">
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="soccerCheckbox" value="남자">
                                <label class="form-check-label" for="soccerCheckbox">남자</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="gameCheckbox" value="여자">
                                <label class="form-check-label" for="gameCheckbox">여자</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="studyCheckbox" value="어린이">
                                <label class="form-check-label" for="studyCheckbox">어린이</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="gameCheckbox" value="청소년">
                                <label class="form-check-label" for="gameCheckbox">청소년</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="studyCheckbox" value="어른">
                                <label class="form-check-label" for="studyCheckbox">어른</label>
                            </div>
                        </div>                    



                    <!-- Buttons -->
                    <button class="btn btn-primary" type="button" id="submit">전송</button>
                    
                </div>

                <div id="result" class="mb-3">
                    <div class="spinner-border text-primary" role="status" style="display: none;">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>

                <!-- 추가된 부분: 이미지 저장 버튼 -->
                <button class="btn btn-success" type="button" id="saveImage">이미지 저장</button>
            </div>
        </div>
    </div>

    <script>
     $(document).ready(function () {
        $('#saveImage').click(function () {
            // 이미지 저장 완료 메시지 표시
            alert('이미지 저장 완료!');
        });

        $('#submit').click(function () {
            // 전송 전에 확인 대화 상자 표시
            if (confirm('이미지를 생성하시겠습니까?')) {
                var promptValue = $('#prompt').val();
                var selectedDate = $('#selectedDate').val();

                // Get the values of selected checkboxes
                var selectedEmotions = [];
                $('input[type=checkbox]:checked').each(function () {
                    selectedEmotions.push($(this).val());
                });

                // Show alert with selected checkboxes' text
                alert('Selected Emotions: ' + selectedEmotions.join(', '));

                $('#result .spinner-border').show();
                $.ajax({
                    url: '/dalle3',
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({ prompt: promptValue + selectedEmotions, date: selectedDate }),
                    success: function (response) {
                        console.log(response);
                        image_url = response.url ? response.url : response;
                        $('#result').html(`<img src="${image_url}" class="img-fluid" style="width:50%" alt="Generated Image">`);
                    },
                    error: function (xhr, status, error) {
                        $('#result').html('API 호출에 실패했습니다: ' + error);
                    },
                    complete: function () {
                        $('#result .spinner-border').hide();
                    }
                });
            }
            // 사용자가 확인하지 않으면 아무 동작도 하지 않음
        });
            // ... (rest of the code remains unchanged)
        });
    </script>
</body>

</html>